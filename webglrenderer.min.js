!function t(e,n,r){function a(i,u){if(!n[i]){if(!e[i]){var l="function"==typeof require&&require;if(!u&&l)return l(i,!0);if(o)return o(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return a(n||t)},c,c.exports,t,e,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(t,e,n){window.Renderer=t("./renderer"),window.Camera=t("./camera")},{"./camera":2,"./renderer":6}],2:[function(t,e,n){"use strict";const r=t("gl-matrix"),a=r.vec3,o=r.mat4,i=t("./lvrl/fly"),u=t("./lvrl/examine"),l=t("./timer");e.exports=function(){var t=this;let e=new u,n=new i,r=null,s={x:0,y:0,mousePress:!1},c={yawIntensity:0,pitchIntensity:0,pivot:a.fromValues(0,0,0),angularVelocity:0,zoomIntensity:0,maximumZoom:0,velocity:a.fromValues(0,0,0),forward:0,backward:0,left:0,right:0,up:0,down:0},f=!1,h=1,m=0;this.rotate=function(t,e){c.yawIntensity=t,c.pitchIntensity=e},this.zoom=function(t){c.zoomIntensity=t},this.setViewMatrix=function(t){f=!0,r.setViewMatrix(t)},this.getViewMatrix=function(){return r.getViewMatrix()},this.setCamera=function(t,e,n){let i=o.create();o.lookAt(i,t,e,n),r.setViewMatrix(i),c.pivot=a.clone(e),c.worldUp=a.clone(n),f=!0},this.setFlyMode=function(){if(m=1,r){let t=r.getViewMatrix();n.setViewMatrix(t),n.applyRestrictions(c.worldUp)}r=n},this.setExamineMode=function(){if(m=0,r){let t=r.getViewMatrix();e.setViewMatrix(t)}r=e},this.installCamera=function(e,n){let a=new l;e&&(e.addEventListener("mousedown",function(t){s.mousePress=!0,s.x=t.clientX,s.y=t.clientY}),e.addEventListener("mouseup",function(t){s.mousePress=!1}),e.addEventListener("mousemove",function(e){s.mousePress&&(t.rotate(-s.x+e.clientX,-s.y+e.clientY),s.x=e.clientX,s.y=e.clientY)}),e.addEventListener("wheel",function(e){let n=0;e.deltaMode==WheelEvent.DOM_DELTA_PIXEL?n=e.deltaY:e.deltaMode==WheelEvent.DOM_DELTA_LINE?n=33*e.deltaY:e.deltaY>0?n=10:e.delta<0&&(n=-10),t.zoom(.001*n)}),window.addEventListener("keydown",function(t){(!document.activeElement||"textarea"!==document.activeElement.tagName&&"input"!==document.activeElement.tagName)&&(!t.shiftKey||"W"!==t.key&&"w"!==t.key&&"ArrowUp"!==t.key?!t.shiftKey||"S"!==t.key&&"s"!==t.key&&"ArrowDown"!==t.key?"W"===t.key||"w"===t.key||"ArrowUp"===t.key?c.forward=1:"S"===t.key||"s"===t.key||"ArrowDown"===t.key?c.backward=1:"A"===t.key||"a"===t.key||"ArrowLeft"===t.key?c.left=1:"D"!==t.key&&"d"!==t.key&&"ArrowRight"!==t.key||(c.right=1):c.down=1:c.up=1)}),window.addEventListener("keyup",function(t){"W"===t.key||"w"===t.key||"ArrowUp"===t.key?(c.up=0,c.forward=0):"S"===t.key||"s"===t.key||"ArrowDown"===t.key?(c.backward=0,c.down=0):"A"===t.key||"a"===t.key||"ArrowLeft"===t.key?c.left=0:"D"!==t.key&&"d"!==t.key&&"ArrowRight"!==t.key||(c.right=0)}));let o=function(){let t=a.elapsedTime();n&&(r.update(t,c)||f)&&(n(r.getViewMatrix(),t),f=!1),window.requestAnimationFrame(o),a.restart()};n&&n(r.getViewMatrix(),0),o()},this.setVelocity=function(t){h=t,c.velocity=a.fromValues(1*h,1*h,1*h)};!function(){t.setExamineMode();let e=a.fromValues(0,0,-5),n=a.fromValues(0,0,0),i=a.fromValues(0,1,0),u=o.create();o.lookAt(u,e,n,i),r.setViewMatrix(u),c.pivot=a.clone(n),c.worldUp=a.clone(i),c.angularVelocity=30,c.maximumZoom=1,c.velocity=a.fromValues(1,1,1)}()}},{"./lvrl/examine":3,"./lvrl/fly":4,"./timer":8,"gl-matrix":5}],3:[function(t,e,n){"use strict";const r=t("gl-matrix"),a=r.vec3,o=r.vec4,i=r.mat4,u=r.glMatrix;e.exports=function(){var t=!1,e=i.create(),n=i.create();this.setViewMatrix=function(r){t=!1,e=i.clone(r),n=i.clone(r)},this.getViewMatrix=function(){return e},this.update=function(r,l){if(u.equals(l.yawIntensity,0)&&u.equals(l.pitchIntensity,0)&&u.equals(l.zoomIntensity,0)&&!t)return!1;{let s=i.clone(e);if(t&&(s=i.clone(n)),!u.equals(l.yawIntensity,0)||!u.equals(l.pitchIntensity,0)){let t=a.fromValues(l.pivot[0],l.pivot[1],l.pivot[2]);a.transformMat4(t,t,s);let e=i.create();i.translate(e,e,t);let n=i.create(),c=a.fromValues(-t[0],-t[1],-t[2]);if(i.translate(n,n,c),!l.lockUpRotation){let t=u.toRadian(l.yawIntensity*l.angularVelocity*r),c=o.fromValues(l.worldUp[0],l.worldUp[1],l.worldUp[2],0);o.transformMat4(c,c,s);let f=a.fromValues(c[0],c[1],c[2]);a.normalize(f,f);let h=i.create();i.rotate(h,h,t,f),i.multiply(s,n,s),i.multiply(s,h,s),i.multiply(s,e,s)}if(!l.lockRightRotation){let t=i.create();i.invert(t,s);let o=a.fromValues(-t[8],-t[9],-t[10]);a.normalize(o,o);let c=Math.acos(a.dot(l.worldUp,o)),f=u.toRadian(l.pitchIntensity*l.angularVelocity*r),h=c+f;if(h<Math.PI&&h>0){let t=i.create();i.rotate(t,t,f,a.fromValues(1,0,0)),i.multiply(s,n,s),i.multiply(s,t,s),i.multiply(s,e,s)}}l.yawIntensity=0,l.pitchIntensity=0}if(!u.equals(l.zoomIntensity,0)){let t=i.create();i.invert(t,s);let e=a.fromValues(t[12],t[13],t[14]),n=a.fromValues(l.pivot[0],l.pivot[1],l.pivot[2]);if(!(u.equals(e[0],n[0])&&u.equals(e[1],n[1])&&u.equals(e[2],n[2]))){let t=a.create();a.normalize(t,a.fromValues(n[0]-e[0],n[1]-e[1],n[2]-e[2]));let r=a.distance(n,e),o=r*l.zoomIntensity;if(r+o>l.maximumZoom){let e=i.create();i.translate(e,e,a.fromValues(t[0]*o,t[1]*o,t[2]*o)),i.multiply(s,s,e)}}l.zoomIntensity=0}return e=i.clone(s),!0}}}},{"gl-matrix":5}],4:[function(t,e,n){"use strict";const r=t("gl-matrix"),a=r.vec3,o=r.vec4,i=r.mat4,u=r.glMatrix;e.exports=function(){let t=i.create(),e=a.fromValues(0,0,-1);const n=u.toRadian(179);this.setFowardDirection=function(t){e=a.clone(t)},this.setViewMatrix=function(e){t=i.clone(e)},this.getViewMatrix=function(){return t},this.update=function(r,l){if(u.equals(l.yawIntensity,0)&&u.equals(l.pitchIntensity,0)&&u.equals(l.forward,0)&&u.equals(l.backward,0)&&u.equals(l.left,0)&&u.equals(l.right,0)&&u.equals(l.up,0)&&u.equals(l.down,0))return!1;let s=i.clone(t),c=o.fromValues(l.worldUp[0],l.worldUp[1],l.worldUp[2],0);o.transformMat4(c,c,s);let f=a.fromValues(c[0],c[1],c[2]);if(a.normalize(f,f),!u.equals(l.yawIntensity,0)||!u.equals(l.pitchIntensity,0)){if(!l.lockUpRotation){let t=i.create();i.rotate(t,t,u.toRadian(l.yawIntensity*l.angularVelocity*r),f),i.multiply(s,t,s)}if(!l.lockRightRotation){let t=i.create();i.invert(t,s);let e=a.fromValues(-t[8],-t[9],-t[10]);a.normalize(e,e);let o=Math.acos(a.dot(l.worldUp,e)),c=u.toRadian(l.pitchIntensity*l.angularVelocity*r),f=o+c;if(f<n&&f>1){let t=i.create();i.rotate(t,t,c,a.fromValues(1,0,0)),i.multiply(s,t,s)}}l.yawIntensity=0,l.pitchIntensity=0}let h=a.create();h[0]=l.velocity[0]*(l.left-l.right)*r,h[1]=l.velocity[1]*(l.down-l.up)*r,h[2]=l.velocity[2]*(l.backward-l.forward)*r;let m=a.clone(e);a.normalize(m,m);let M=a.create();a.cross(M,m,f),a.normalize(M,M);let d=a.create();a.cross(d,M,m),a.normalize(d,d);let v=a.fromValues(m[0]*h[2]+d[0]*h[1]+M[0]*h[0],m[1]*h[2]+d[1]*h[1]+M[1]*h[0],m[2]*h[2]+d[2]*h[1]+M[2]*h[0]),p=i.create();return i.translate(p,p,v),i.multiply(s,p,s),t=i.clone(s),!0},this.applyRestrictions=function(e){let n=i.create();i.invert(n,t);let r=n[15],o=a.fromValues(n[12]/r,n[13]/r,n[14]/r),u=a.fromValues(-n[8],-n[9],-n[10]),l=a.fromValues(o[0]+u[0],o[1]+u[1],o[2]+u[2]);i.lookAt(t,o,l,e)}}},{"gl-matrix":5}],5:[function(t,e,n){!function(t,r){if("object"==typeof n&&"object"==typeof e)e.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var a=r();for(var o in a)("object"==typeof n?n:t)[o]=a[o]}}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=a=t},e.toRadian=function(t){return t*o},e.equals=function(t,e){return Math.abs(t-e)<=r*Math.max(1,Math.abs(t),Math.abs(e))};var r=e.EPSILON=1e-6,a=e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,o=(e.RANDOM=Math.random,Math.PI/180)},function(t,e,n){"use strict";function r(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=n[0],m=n[1],M=n[2],d=n[3],v=n[4],p=n[5],b=n[6],E=n[7],A=n[8];return t[0]=h*r+m*i+M*s,t[1]=h*a+m*u+M*c,t[2]=h*o+m*l+M*f,t[3]=d*r+v*i+p*s,t[4]=d*a+v*u+p*c,t[5]=d*o+v*l+p*f,t[6]=b*r+E*i+A*s,t[7]=b*a+E*u+A*c,t[8]=b*o+E*l+A*f,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new o.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new o.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,n,r,a,i,u,l,s){var c=new o.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=a,c[5]=i,c[6]=u,c[7]=l,c[8]=s,c},e.set=function(t,e,n,r,a,o,i,u,l,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=s,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=c*i-u*s,h=-c*o+u*l,m=s*o-i*l,M=n*f+r*h+a*m;return M?(M=1/M,t[0]=f*M,t[1]=(-c*r+a*s)*M,t[2]=(u*r-a*i)*M,t[3]=h*M,t[4]=(c*n-a*l)*M,t[5]=(-u*n+a*o)*M,t[6]=m*M,t[7]=(-s*n+r*l)*M,t[8]=(i*n-r*o)*M,t):null},e.adjoint=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8];return t[0]=i*c-u*s,t[1]=a*s-r*c,t[2]=r*u-a*i,t[3]=u*l-o*c,t[4]=n*c-a*l,t[5]=a*o-n*u,t[6]=o*s-i*l,t[7]=r*l-n*s,t[8]=n*i-r*o,t},e.determinant=function(t){var e=t[0],n=t[1],r=t[2],a=t[3],o=t[4],i=t[5],u=t[6],l=t[7],s=t[8];return e*(s*o-i*l)+n*(-s*a+i*u)+r*(l*a-o*u)},e.multiply=r,e.translate=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=n[0],m=n[1];return t[0]=r,t[1]=a,t[2]=o,t[3]=i,t[4]=u,t[5]=l,t[6]=h*r+m*i+s,t[7]=h*a+m*u+c,t[8]=h*o+m*l+f,t},e.rotate=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=Math.sin(n),m=Math.cos(n);return t[0]=m*r+h*i,t[1]=m*a+h*u,t[2]=m*o+h*l,t[3]=m*i-h*r,t[4]=m*u-h*a,t[5]=m*l-h*o,t[6]=s,t[7]=c,t[8]=f,t},e.scale=function(t,e,n){var r=n[0],a=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=n+n,u=r+r,l=a+a,s=n*i,c=r*i,f=r*u,h=a*i,m=a*u,M=a*l,d=o*i,v=o*u,p=o*l;return t[0]=1-f-M,t[3]=c-p,t[6]=h+v,t[1]=c+p,t[4]=1-s-M,t[7]=m-d,t[2]=h-v,t[5]=m+d,t[8]=1-s-f,t},e.normalFromMat4=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],h=e[10],m=e[11],M=e[12],d=e[13],v=e[14],p=e[15],b=n*u-r*i,E=n*l-a*i,A=n*s-o*i,R=r*l-a*u,x=r*s-o*u,y=a*s-o*l,w=c*d-f*M,g=c*v-h*M,T=c*p-m*M,_=f*v-h*d,P=f*p-m*d,I=h*p-m*v,S=b*I-E*P+A*_+R*T-x*g+y*w;return S?(S=1/S,t[0]=(u*I-l*P+s*_)*S,t[1]=(l*T-i*I-s*g)*S,t[2]=(i*P-u*T+s*w)*S,t[3]=(a*P-r*I-o*_)*S,t[4]=(n*I-a*T+o*g)*S,t[5]=(r*T-n*P-o*w)*S,t[6]=(d*y-v*x+p*R)*S,t[7]=(v*A-M*y-p*E)*S,t[8]=(M*x-d*A+p*b)*S,t):null},e.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],i=t[3],u=t[4],l=t[5],s=t[6],c=t[7],f=t[8],h=e[0],m=e[1],M=e[2],d=e[3],v=e[4],p=e[5],b=e[6],E=e[7],A=e[8];return Math.abs(n-h)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-m)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(a-M)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(i-d)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(u-v)<=o.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(l-p)<=o.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(s-b)<=o.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(c-E)<=o.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(f-A)<=o.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))};var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.mul=r,e.sub=a},function(t,e,n){"use strict";function r(){var t=new M.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t}function a(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function o(t,e,n){var r=new M.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r}function i(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function u(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function l(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function s(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(n*n+r*r+a*a)}function c(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return n*n+r*r+a*a}function f(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function h(t,e){var n=e[0],r=e[1],a=e[2],o=n*n+r*r+a*a;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function m(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=r,e.clone=function(t){var e=new M.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=a,e.fromValues=o,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},e.subtract=i,e.multiply=u,e.divide=l,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},e.distance=s,e.squaredDistance=c,e.squaredLength=f,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=h,e.dot=m,e.cross=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=n[0],u=n[1],l=n[2];return t[0]=a*l-o*u,t[1]=o*i-r*l,t[2]=r*u-a*i,t},e.lerp=function(t,e,n,r){var a=e[0],o=e[1],i=e[2];return t[0]=a+r*(n[0]-a),t[1]=o+r*(n[1]-o),t[2]=i+r*(n[2]-i),t},e.hermite=function(t,e,n,r,a,o){var i=o*o,u=i*(2*o-3)+1,l=i*(o-2)+o,s=i*(o-1),c=i*(3-2*o);return t[0]=e[0]*u+n[0]*l+r[0]*s+a[0]*c,t[1]=e[1]*u+n[1]*l+r[1]*s+a[1]*c,t[2]=e[2]*u+n[2]*l+r[2]*s+a[2]*c,t},e.bezier=function(t,e,n,r,a,o){var i=1-o,u=i*i,l=o*o,s=u*i,c=3*o*u,f=3*l*i,h=l*o;return t[0]=e[0]*s+n[0]*c+r[0]*f+a[0]*h,t[1]=e[1]*s+n[1]*c+r[1]*f+a[1]*h,t[2]=e[2]*s+n[2]*c+r[2]*f+a[2]*h,t},e.random=function(t,e){e=e||1;var n=2*M.RANDOM()*Math.PI,r=2*M.RANDOM()-1,a=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*a,t[1]=Math.sin(n)*a,t[2]=r*e,t},e.transformMat4=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=n[3]*r+n[7]*a+n[11]*o+n[15];return i=i||1,t[0]=(n[0]*r+n[4]*a+n[8]*o+n[12])/i,t[1]=(n[1]*r+n[5]*a+n[9]*o+n[13])/i,t[2]=(n[2]*r+n[6]*a+n[10]*o+n[14])/i,t},e.transformMat3=function(t,e,n){var r=e[0],a=e[1],o=e[2];return t[0]=r*n[0]+a*n[3]+o*n[6],t[1]=r*n[1]+a*n[4]+o*n[7],t[2]=r*n[2]+a*n[5]+o*n[8],t},e.transformQuat=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=n[0],u=n[1],l=n[2],s=n[3],c=s*r+u*o-l*a,f=s*a+l*r-i*o,h=s*o+i*a-u*r,m=-i*r-u*a-l*o;return t[0]=c*s+m*-i+f*-l-h*-u,t[1]=f*s+m*-u+h*-i-c*-l,t[2]=h*s+m*-l+c*-u-f*-i,t},e.rotateX=function(t,e,n,r){var a=[],o=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],o[0]=a[0],o[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),o[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},e.rotateY=function(t,e,n,r){var a=[],o=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],o[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),o[1]=a[1],o[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},e.rotateZ=function(t,e,n,r){var a=[],o=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],o[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),o[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),o[2]=a[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},e.angle=function(t,e){var n=o(t[0],t[1],t[2]),r=o(e[0],e[1],e[2]);h(n,n),h(r,r);var a=m(n,r);return a>1?0:a<-1?Math.PI:Math.acos(a)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],o=e[0],i=e[1],u=e[2];return Math.abs(n-o)<=M.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-i)<=M.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-u)<=M.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))};var M=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.sub=i,e.mul=u,e.div=l,e.dist=s,e.sqrDist=c,e.len=a,e.sqrLen=f,e.forEach=function(){var t=r();return function(e,n,r,a,o,i){var u=void 0,l=void 0;for(n||(n=3),r||(r=0),l=a?Math.min(a*n+r,e.length):e.length,u=r;u<l;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}()},function(t,e,n){"use strict";function r(){var t=new m.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function o(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function i(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function u(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function l(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+a*a+o*o)}function s(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+a*a+o*o}function c(t){var e=t[0],n=t[1],r=t[2],a=t[3];return Math.sqrt(e*e+n*n+r*r+a*a)}function f(t){var e=t[0],n=t[1],r=t[2],a=t[3];return e*e+n*n+r*r+a*a}function h(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=n*n+r*r+a*a+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=n*i,t[1]=r*i,t[2]=a*i,t[3]=o*i),t}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=r,e.clone=function(t){var e=new m.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,n,r){var a=new m.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,n,r,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=a,e.multiply=o,e.divide=i,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=u,e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},e.distance=l,e.squaredDistance=s,e.length=c,e.squaredLength=f,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=h,e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,n,r){var a=e[0],o=e[1],i=e[2],u=e[3];return t[0]=a+r*(n[0]-a),t[1]=o+r*(n[1]-o),t[2]=i+r*(n[2]-i),t[3]=u+r*(n[3]-u),t},e.random=function(t,e){return e=e||1,t[0]=m.RANDOM(),t[1]=m.RANDOM(),t[2]=m.RANDOM(),t[3]=m.RANDOM(),h(t,t),u(t,t,e),t},e.transformMat4=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3];return t[0]=n[0]*r+n[4]*a+n[8]*o+n[12]*i,t[1]=n[1]*r+n[5]*a+n[9]*o+n[13]*i,t[2]=n[2]*r+n[6]*a+n[10]*o+n[14]*i,t[3]=n[3]*r+n[7]*a+n[11]*o+n[15]*i,t},e.transformQuat=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=n[0],u=n[1],l=n[2],s=n[3],c=s*r+u*o-l*a,f=s*a+l*r-i*o,h=s*o+i*a-u*r,m=-i*r-u*a-l*o;return t[0]=c*s+m*-i+f*-l-h*-u,t[1]=f*s+m*-u+h*-i-c*-l,t[2]=h*s+m*-l+c*-u-f*-i,t[3]=e[3],t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],o=t[3],i=e[0],u=e[1],l=e[2],s=e[3];return Math.abs(n-i)<=m.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-u)<=m.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-l)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-s)<=m.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))};var m=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.sub=a,e.mul=o,e.div=i,e.dist=l,e.sqrDist=s,e.len=c,e.sqrLen=f,e.forEach=function(){var t=r();return function(e,n,r,a,o,i){var u=void 0,l=void 0;for(n||(n=4),r||(r=0),l=a?Math.min(a*n+r,e.length):e.length,u=r;u<l;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}()},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0;var a=r(n(0)),o=r(n(5)),i=r(n(6)),u=r(n(1)),l=r(n(7)),s=r(n(8)),c=r(n(9)),f=r(n(2)),h=r(n(3));e.glMatrix=a,e.mat2=o,e.mat2d=i,e.mat3=u,e.mat4=l,e.quat=s,e.vec2=c,e.vec3=f,e.vec4=h},function(t,e,n){"use strict";function r(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=n[0],l=n[1],s=n[2],c=n[3];return t[0]=r*u+o*l,t[1]=a*u+i*l,t[2]=r*s+o*c,t[3]=a*s+i*c,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new o.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){var e=new o.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,n,r){var a=new o.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a},e.set=function(t,e,n,r,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t},e.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=n*o-a*r;return i?(i=1/i,t[0]=o*i,t[1]=-r*i,t[2]=-a*i,t[3]=n*i,t):null},e.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=r,e.rotate=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=r*l+o*u,t[1]=a*l+i*u,t[2]=r*-u+o*l,t[3]=a*-u+i*l,t},e.scale=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=n[0],l=n[1];return t[0]=r*u,t[1]=a*u,t[2]=o*l,t[3]=i*l,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=a,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],i=t[3],u=e[0],l=e[1],s=e[2],c=e[3];return Math.abs(n-u)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-l)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(a-s)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(i-c)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t};var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.mul=r,e.sub=a},function(t,e,n){"use strict";function r(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=n[0],c=n[1],f=n[2],h=n[3],m=n[4],M=n[5];return t[0]=r*s+o*c,t[1]=a*s+i*c,t[2]=r*f+o*h,t[3]=a*f+i*h,t[4]=r*m+o*M+u,t[5]=a*m+i*M+l,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new o.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.clone=function(t){var e=new o.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,n,r,a,i){var u=new o.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=a,u[5]=i,u},e.set=function(t,e,n,r,a,o,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=o,t[5]=i,t},e.invert=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=n*o-r*a;return l?(l=1/l,t[0]=o*l,t[1]=-r*l,t[2]=-a*l,t[3]=n*l,t[4]=(a*u-o*i)*l,t[5]=(r*i-n*u)*l,t):null},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=r,e.rotate=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*s,t[1]=a*c+i*s,t[2]=r*-s+o*c,t[3]=a*-s+i*c,t[4]=u,t[5]=l,t},e.scale=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=n[0],c=n[1];return t[0]=r*s,t[1]=a*s,t[2]=o*c,t[3]=i*c,t[4]=u,t[5]=l,t},e.translate=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=n[0],c=n[1];return t[0]=r,t[1]=a,t[2]=o,t[3]=i,t[4]=r*s+o*c+u,t[5]=a*s+i*c+l,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],i=t[3],u=t[4],l=t[5],s=e[0],c=e[1],f=e[2],h=e[3],m=e[4],M=e[5];return Math.abs(n-s)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-c)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(a-f)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(i-h)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(u-m)<=o.EPSILON*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(l-M)<=o.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))};var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.mul=r,e.sub=a},function(t,e,n){"use strict";function r(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=e[9],m=e[10],M=e[11],d=e[12],v=e[13],p=e[14],b=e[15],E=n[0],A=n[1],R=n[2],x=n[3];return t[0]=E*r+A*u+R*f+x*d,t[1]=E*a+A*l+R*h+x*v,t[2]=E*o+A*s+R*m+x*p,t[3]=E*i+A*c+R*M+x*b,E=n[4],A=n[5],R=n[6],x=n[7],t[4]=E*r+A*u+R*f+x*d,t[5]=E*a+A*l+R*h+x*v,t[6]=E*o+A*s+R*m+x*p,t[7]=E*i+A*c+R*M+x*b,E=n[8],A=n[9],R=n[10],x=n[11],t[8]=E*r+A*u+R*f+x*d,t[9]=E*a+A*l+R*h+x*v,t[10]=E*o+A*s+R*m+x*p,t[11]=E*i+A*c+R*M+x*b,E=n[12],A=n[13],R=n[14],x=n[15],t[12]=E*r+A*u+R*f+x*d,t[13]=E*a+A*l+R*h+x*v,t[14]=E*o+A*s+R*m+x*p,t[15]=E*i+A*c+R*M+x*b,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new o.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){var e=new o.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,n,r,a,i,u,l,s,c,f,h,m,M,d,v){var p=new o.ARRAY_TYPE(16);return p[0]=t,p[1]=e,p[2]=n,p[3]=r,p[4]=a,p[5]=i,p[6]=u,p[7]=l,p[8]=s,p[9]=c,p[10]=f,p[11]=h,p[12]=m,p[13]=M,p[14]=d,p[15]=v,p},e.set=function(t,e,n,r,a,o,i,u,l,s,c,f,h,m,M,d,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=s,t[9]=c,t[10]=f,t[11]=h,t[12]=m,t[13]=M,t[14]=d,t[15]=v,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],a=e[3],o=e[6],i=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=a,t[13]=i,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],h=e[10],m=e[11],M=e[12],d=e[13],v=e[14],p=e[15],b=n*u-r*i,E=n*l-a*i,A=n*s-o*i,R=r*l-a*u,x=r*s-o*u,y=a*s-o*l,w=c*d-f*M,g=c*v-h*M,T=c*p-m*M,_=f*v-h*d,P=f*p-m*d,I=h*p-m*v,S=b*I-E*P+A*_+R*T-x*g+y*w;return S?(S=1/S,t[0]=(u*I-l*P+s*_)*S,t[1]=(a*P-r*I-o*_)*S,t[2]=(d*y-v*x+p*R)*S,t[3]=(h*x-f*y-m*R)*S,t[4]=(l*T-i*I-s*g)*S,t[5]=(n*I-a*T+o*g)*S,t[6]=(v*A-M*y-p*E)*S,t[7]=(c*y-h*A+m*E)*S,t[8]=(i*P-u*T+s*w)*S,t[9]=(r*T-n*P-o*w)*S,t[10]=(M*x-d*A+p*b)*S,t[11]=(f*A-c*x-m*b)*S,t[12]=(u*g-i*_-l*w)*S,t[13]=(n*_-r*g+a*w)*S,t[14]=(d*E-M*R-v*b)*S,t[15]=(c*R-f*E+h*b)*S,t):null},e.adjoint=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],h=e[10],m=e[11],M=e[12],d=e[13],v=e[14],p=e[15];return t[0]=u*(h*p-m*v)-f*(l*p-s*v)+d*(l*m-s*h),t[1]=-(r*(h*p-m*v)-f*(a*p-o*v)+d*(a*m-o*h)),t[2]=r*(l*p-s*v)-u*(a*p-o*v)+d*(a*s-o*l),t[3]=-(r*(l*m-s*h)-u*(a*m-o*h)+f*(a*s-o*l)),t[4]=-(i*(h*p-m*v)-c*(l*p-s*v)+M*(l*m-s*h)),t[5]=n*(h*p-m*v)-c*(a*p-o*v)+M*(a*m-o*h),t[6]=-(n*(l*p-s*v)-i*(a*p-o*v)+M*(a*s-o*l)),t[7]=n*(l*m-s*h)-i*(a*m-o*h)+c*(a*s-o*l),t[8]=i*(f*p-m*d)-c*(u*p-s*d)+M*(u*m-s*f),t[9]=-(n*(f*p-m*d)-c*(r*p-o*d)+M*(r*m-o*f)),t[10]=n*(u*p-s*d)-i*(r*p-o*d)+M*(r*s-o*u),t[11]=-(n*(u*m-s*f)-i*(r*m-o*f)+c*(r*s-o*u)),t[12]=-(i*(f*v-h*d)-c*(u*v-l*d)+M*(u*h-l*f)),t[13]=n*(f*v-h*d)-c*(r*v-a*d)+M*(r*h-a*f),t[14]=-(n*(u*v-l*d)-i*(r*v-a*d)+M*(r*l-a*u)),t[15]=n*(u*h-l*f)-i*(r*h-a*f)+c*(r*l-a*u),t},e.determinant=function(t){var e=t[0],n=t[1],r=t[2],a=t[3],o=t[4],i=t[5],u=t[6],l=t[7],s=t[8],c=t[9],f=t[10],h=t[11],m=t[12],M=t[13],d=t[14],v=t[15];return(e*i-n*o)*(f*v-h*d)-(e*u-r*o)*(c*v-h*M)+(e*l-a*o)*(c*d-f*M)+(n*u-r*i)*(s*v-h*m)-(n*l-a*i)*(s*d-f*m)+(r*l-a*u)*(s*M-c*m)},e.multiply=r,e.translate=function(t,e,n){var r=n[0],a=n[1],o=n[2],i=void 0,u=void 0,l=void 0,s=void 0,c=void 0,f=void 0,h=void 0,m=void 0,M=void 0,d=void 0,v=void 0,p=void 0;return e===t?(t[12]=e[0]*r+e[4]*a+e[8]*o+e[12],t[13]=e[1]*r+e[5]*a+e[9]*o+e[13],t[14]=e[2]*r+e[6]*a+e[10]*o+e[14],t[15]=e[3]*r+e[7]*a+e[11]*o+e[15]):(i=e[0],u=e[1],l=e[2],s=e[3],c=e[4],f=e[5],h=e[6],m=e[7],M=e[8],d=e[9],v=e[10],p=e[11],t[0]=i,t[1]=u,t[2]=l,t[3]=s,t[4]=c,t[5]=f,t[6]=h,t[7]=m,t[8]=M,t[9]=d,t[10]=v,t[11]=p,t[12]=i*r+c*a+M*o+e[12],t[13]=u*r+f*a+d*o+e[13],t[14]=l*r+h*a+v*o+e[14],t[15]=s*r+m*a+p*o+e[15]),t},e.scale=function(t,e,n){var r=n[0],a=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,n,r){var a=r[0],i=r[1],u=r[2],l=Math.sqrt(a*a+i*i+u*u),s=void 0,c=void 0,f=void 0,h=void 0,m=void 0,M=void 0,d=void 0,v=void 0,p=void 0,b=void 0,E=void 0,A=void 0,R=void 0,x=void 0,y=void 0,w=void 0,g=void 0,T=void 0,_=void 0,P=void 0,I=void 0,S=void 0,O=void 0,L=void 0;return Math.abs(l)<o.EPSILON?null:(l=1/l,a*=l,i*=l,u*=l,s=Math.sin(n),c=Math.cos(n),f=1-c,h=e[0],m=e[1],M=e[2],d=e[3],v=e[4],p=e[5],b=e[6],E=e[7],A=e[8],R=e[9],x=e[10],y=e[11],w=a*a*f+c,g=i*a*f+u*s,T=u*a*f-i*s,_=a*i*f-u*s,P=i*i*f+c,I=u*i*f+a*s,S=a*u*f+i*s,O=i*u*f-a*s,L=u*u*f+c,t[0]=h*w+v*g+A*T,t[1]=m*w+p*g+R*T,t[2]=M*w+b*g+x*T,t[3]=d*w+E*g+y*T,t[4]=h*_+v*P+A*I,t[5]=m*_+p*P+R*I,t[6]=M*_+b*P+x*I,t[7]=d*_+E*P+y*I,t[8]=h*S+v*O+A*L,t[9]=m*S+p*O+R*L,t[10]=M*S+b*O+x*L,t[11]=d*S+E*O+y*L,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},e.rotateX=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),o=e[4],i=e[5],u=e[6],l=e[7],s=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*a+s*r,t[5]=i*a+c*r,t[6]=u*a+f*r,t[7]=l*a+h*r,t[8]=s*a-o*r,t[9]=c*a-i*r,t[10]=f*a-u*r,t[11]=h*a-l*r,t},e.rotateY=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),o=e[0],i=e[1],u=e[2],l=e[3],s=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*a-s*r,t[1]=i*a-c*r,t[2]=u*a-f*r,t[3]=l*a-h*r,t[8]=o*r+s*a,t[9]=i*r+c*a,t[10]=u*r+f*a,t[11]=l*r+h*a,t},e.rotateZ=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),o=e[0],i=e[1],u=e[2],l=e[3],s=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*a+s*r,t[1]=i*a+c*r,t[2]=u*a+f*r,t[3]=l*a+h*r,t[4]=s*a-o*r,t[5]=c*a-i*r,t[6]=f*a-u*r,t[7]=h*a-l*r,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,n){var r=n[0],a=n[1],i=n[2],u=Math.sqrt(r*r+a*a+i*i),l=void 0,s=void 0,c=void 0;return Math.abs(u)<o.EPSILON?null:(u=1/u,r*=u,a*=u,i*=u,l=Math.sin(e),s=Math.cos(e),c=1-s,t[0]=r*r*c+s,t[1]=a*r*c+i*l,t[2]=i*r*c-a*l,t[3]=0,t[4]=r*a*c-i*l,t[5]=a*a*c+s,t[6]=i*a*c+r*l,t[7]=0,t[8]=r*i*c+a*l,t[9]=a*i*c-r*l,t[10]=i*i*c+s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=r+r,l=a+a,s=o+o,c=r*u,f=r*l,h=r*s,m=a*l,M=a*s,d=o*s,v=i*u,p=i*l,b=i*s;return t[0]=1-(m+d),t[1]=f+b,t[2]=h-p,t[3]=0,t[4]=f-b,t[5]=1-(c+d),t[6]=M+v,t[7]=0,t[8]=h+p,t[9]=M-v,t[10]=1-(c+m),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[4],i=e[5],u=e[6],l=e[8],s=e[9],c=e[10];return t[0]=Math.sqrt(n*n+r*r+a*a),t[1]=Math.sqrt(o*o+i*i+u*u),t[2]=Math.sqrt(l*l+s*s+c*c),t},e.getRotation=function(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},e.fromRotationTranslationScale=function(t,e,n,r){var a=e[0],o=e[1],i=e[2],u=e[3],l=a+a,s=o+o,c=i+i,f=a*l,h=a*s,m=a*c,M=o*s,d=o*c,v=i*c,p=u*l,b=u*s,E=u*c,A=r[0],R=r[1],x=r[2];return t[0]=(1-(M+v))*A,t[1]=(h+E)*A,t[2]=(m-b)*A,t[3]=0,t[4]=(h-E)*R,t[5]=(1-(f+v))*R,t[6]=(d+p)*R,t[7]=0,t[8]=(m+b)*x,t[9]=(d-p)*x,t[10]=(1-(f+M))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,n,r,a){var o=e[0],i=e[1],u=e[2],l=e[3],s=o+o,c=i+i,f=u+u,h=o*s,m=o*c,M=o*f,d=i*c,v=i*f,p=u*f,b=l*s,E=l*c,A=l*f,R=r[0],x=r[1],y=r[2],w=a[0],g=a[1],T=a[2];return t[0]=(1-(d+p))*R,t[1]=(m+A)*R,t[2]=(M-E)*R,t[3]=0,t[4]=(m-A)*x,t[5]=(1-(h+p))*x,t[6]=(v+b)*x,t[7]=0,t[8]=(M+E)*y,t[9]=(v-b)*y,t[10]=(1-(h+d))*y,t[11]=0,t[12]=n[0]+w-(t[0]*w+t[4]*g+t[8]*T),t[13]=n[1]+g-(t[1]*w+t[5]*g+t[9]*T),t[14]=n[2]+T-(t[2]*w+t[6]*g+t[10]*T),t[15]=1,t},e.fromQuat=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=n+n,u=r+r,l=a+a,s=n*i,c=r*i,f=r*u,h=a*i,m=a*u,M=a*l,d=o*i,v=o*u,p=o*l;return t[0]=1-f-M,t[1]=c+p,t[2]=h-v,t[3]=0,t[4]=c-p,t[5]=1-s-M,t[6]=m+d,t[7]=0,t[8]=h+v,t[9]=m-d,t[10]=1-s-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,n,r,a,o,i){var u=1/(n-e),l=1/(a-r),s=1/(o-i);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(a+r)*l,t[10]=(i+o)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*s,t[15]=0,t},e.perspective=function(t,e,n,r,a){var o=1/Math.tan(e/2),i=1/(r-a);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+r)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*r*i,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,e,n,r){var a=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),l=2/(i+u),s=2/(a+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-(i-u)*l*.5,t[9]=(a-o)*s*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},e.ortho=function(t,e,n,r,a,o,i){var u=1/(e-n),l=1/(r-a),s=1/(o-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(e+n)*u,t[13]=(a+r)*l,t[14]=(i+o)*s,t[15]=1,t},e.lookAt=function(t,e,n,r){var a=void 0,i=void 0,u=void 0,l=void 0,s=void 0,c=void 0,f=void 0,h=void 0,m=void 0,M=void 0,d=e[0],v=e[1],p=e[2],b=r[0],E=r[1],A=r[2],R=n[0],x=n[1],y=n[2];return Math.abs(d-R)<o.EPSILON&&Math.abs(v-x)<o.EPSILON&&Math.abs(p-y)<o.EPSILON?mat4.identity(t):(f=d-R,h=v-x,m=p-y,M=1/Math.sqrt(f*f+h*h+m*m),f*=M,h*=M,m*=M,a=E*m-A*h,i=A*f-b*m,u=b*h-E*f,(M=Math.sqrt(a*a+i*i+u*u))?(a*=M=1/M,i*=M,u*=M):(a=0,i=0,u=0),l=h*u-m*i,s=m*a-f*u,c=f*i-h*a,(M=Math.sqrt(l*l+s*s+c*c))?(l*=M=1/M,s*=M,c*=M):(l=0,s=0,c=0),t[0]=a,t[1]=l,t[2]=f,t[3]=0,t[4]=i,t[5]=s,t[6]=h,t[7]=0,t[8]=u,t[9]=c,t[10]=m,t[11]=0,t[12]=-(a*d+i*v+u*p),t[13]=-(l*d+s*v+c*p),t[14]=-(f*d+h*v+m*p),t[15]=1,t)},e.targetTo=function(t,e,n,r){var a=e[0],o=e[1],i=e[2],u=r[0],l=r[1],s=r[2],c=a-n[0],f=o-n[1],h=i-n[2],m=c*c+f*f+h*h;m>0&&(c*=m=1/Math.sqrt(m),f*=m,h*=m);var M=l*h-s*f,d=s*c-u*h,v=u*f-l*c;return t[0]=M,t[1]=d,t[2]=v,t[3]=0,t[4]=f*v-h*d,t[5]=h*M-c*v,t[6]=c*d-f*M,t[7]=0,t[8]=c,t[9]=f,t[10]=h,t[11]=0,t[12]=a,t[13]=o,t[14]=i,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],i=t[3],u=t[4],l=t[5],s=t[6],c=t[7],f=t[8],h=t[9],m=t[10],M=t[11],d=t[12],v=t[13],p=t[14],b=t[15],E=e[0],A=e[1],R=e[2],x=e[3],y=e[4],w=e[5],g=e[6],T=e[7],_=e[8],P=e[9],I=e[10],S=e[11],O=e[12],L=e[13],N=e[14],U=e[15];return Math.abs(n-E)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(r-A)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(A))&&Math.abs(a-R)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(i-x)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(u-y)<=o.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(l-w)<=o.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(s-g)<=o.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-T)<=o.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(f-_)<=o.EPSILON*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(h-P)<=o.EPSILON*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(m-I)<=o.EPSILON*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(M-S)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(S))&&Math.abs(d-O)<=o.EPSILON*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(v-L)<=o.EPSILON*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(p-N)<=o.EPSILON*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(b-U)<=o.EPSILON*Math.max(1,Math.abs(b),Math.abs(U))};var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.mul=r,e.sub=a},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(){var t=new s.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function o(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function i(t,e,n){var r=e[0],a=e[1],o=e[2],i=e[3],u=n[0],l=n[1],s=n[2],c=n[3];return t[0]=r*c+i*u+a*s-o*l,t[1]=a*c+i*l+o*u-r*s,t[2]=o*c+i*s+r*l-a*u,t[3]=i*c-r*u-a*l-o*s,t}function u(t,e,n,r){var a=e[0],o=e[1],i=e[2],u=e[3],l=n[0],s=n[1],c=n[2],f=n[3],h=void 0,m=void 0,M=void 0,d=void 0,v=void 0;return(m=a*l+o*s+i*c+u*f)<0&&(m=-m,l=-l,s=-s,c=-c,f=-f),1-m>1e-6?(h=Math.acos(m),M=Math.sin(h),d=Math.sin((1-r)*h)/M,v=Math.sin(r*h)/M):(d=1-r,v=r),t[0]=d*a+v*l,t[1]=d*o+v*s,t[2]=d*i+v*c,t[3]=d*u+v*f,t}function l(t,e){var n=e[0]+e[4]+e[8],r=void 0;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var o=(a+1)%3,i=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*o+o]-e[3*i+i]+1),t[a]=.5*r,r=.5/r,t[3]=(e[3*o+i]-e[3*i+o])*r,t[o]=(e[3*o+a]+e[3*a+o])*r,t[i]=(e[3*i+a]+e[3*a+i])*r}return t}Object.defineProperty(e,"__esModule",{value:!0}),e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0,e.create=a,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=o,e.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n},e.multiply=i,e.rotateX=function(t,e,n){n*=.5;var r=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=r*l+i*u,t[1]=a*l+o*u,t[2]=o*l-a*u,t[3]=i*l-r*u,t},e.rotateY=function(t,e,n){n*=.5;var r=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=r*l-o*u,t[1]=a*l+i*u,t[2]=o*l+r*u,t[3]=i*l-a*u,t},e.rotateZ=function(t,e,n){n*=.5;var r=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=r*l+a*u,t[1]=a*l-r*u,t[2]=o*l+i*u,t[3]=i*l-o*u,t},e.calculateW=function(t,e){var n=e[0],r=e[1],a=e[2];return t[0]=n,t[1]=r,t[2]=a,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-a*a)),t},e.slerp=u,e.invert=function(t,e){var n=e[0],r=e[1],a=e[2],o=e[3],i=n*n+r*r+a*a+o*o,u=i?1/i:0;return t[0]=-n*u,t[1]=-r*u,t[2]=-a*u,t[3]=o*u,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=l,e.fromEuler=function(t,e,n,r){var a=.5*Math.PI/180;e*=a,n*=a,r*=a;var o=Math.sin(e),i=Math.cos(e),u=Math.sin(n),l=Math.cos(n),s=Math.sin(r),c=Math.cos(r);return t[0]=o*l*c-i*u*s,t[1]=i*u*c+o*l*s,t[2]=i*l*s-o*u*c,t[3]=i*l*c+o*u*s,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};var s=r(n(0)),c=r(n(1)),f=r(n(2)),h=r(n(3)),m=(e.clone=h.clone,e.fromValues=h.fromValues,e.copy=h.copy,e.set=h.set,e.add=h.add,e.mul=i,e.scale=h.scale,e.dot=h.dot,e.lerp=h.lerp,e.length=h.length),M=(e.len=m,e.squaredLength=h.squaredLength),d=(e.sqrLen=M,e.normalize=h.normalize);e.exactEquals=h.exactEquals,e.equals=h.equals,e.rotationTo=function(){var t=f.create(),e=f.fromValues(1,0,0),n=f.fromValues(0,1,0);return function(r,a,i){var u=f.dot(a,i);return u<-.999999?(f.cross(t,e,a),f.len(t)<1e-6&&f.cross(t,n,a),f.normalize(t,t),o(r,t,Math.PI),r):u>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(f.cross(t,a,i),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+u,d(r,r))}}(),e.sqlerp=function(){var t=a(),e=a();return function(n,r,a,o,i,l){return u(t,r,i,l),u(e,a,o,l),u(n,t,e,2*l*(1-l)),n}}(),e.setAxes=function(){var t=c.create();return function(e,n,r,a){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],d(e,l(e,t))}}()},function(t,e,n){"use strict";function r(){var t=new f.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function o(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function i(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function u(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function l(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function s(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function c(t){var e=t[0],n=t[1];return e*e+n*n}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0,e.create=r,e.clone=function(t){var e=new f.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){var n=new f.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,n){return t[0]=e,t[1]=n,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},e.subtract=a,e.multiply=o,e.divide=i,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},e.distance=u,e.squaredDistance=l,e.length=s,e.squaredLength=c,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var n=e[0],r=e[1],a=n*n+r*r;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a),t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},e.lerp=function(t,e,n,r){var a=e[0],o=e[1];return t[0]=a+r*(n[0]-a),t[1]=o+r*(n[1]-o),t},e.random=function(t,e){e=e||1;var n=2*f.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},e.transformMat2=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[2]*a,t[1]=n[1]*r+n[3]*a,t},e.transformMat2d=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[2]*a+n[4],t[1]=n[1]*r+n[3]*a+n[5],t},e.transformMat3=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[3]*a+n[6],t[1]=n[1]*r+n[4]*a+n[7],t},e.transformMat4=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[4]*a+n[12],t[1]=n[1]*r+n[5]*a+n[13],t},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){var n=t[0],r=t[1],a=e[0],o=e[1];return Math.abs(n-a)<=f.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=f.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))};var f=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.len=s,e.sub=a,e.mul=o,e.div=i,e.dist=u,e.sqrDist=l,e.sqrLen=c,e.forEach=function(){var t=r();return function(e,n,r,a,o,i){var u=void 0,l=void 0;for(n||(n=2),r||(r=0),l=a?Math.min(a*n+r,e.length):e.length,u=r;u<l;u+=n)t[0]=e[u],t[1]=e[u+1],o(t,t,i),e[u]=t[0],e[u+1]=t[1];return e}}()}])})},{}],6:[function(t,e,n){"use strict";function r(){function t(t){for(let e=b.length-1;e>=0;e--){let n=b[e],r=t.indexOf(n);r<0&&(o.disableVertexAttribArray(n),b.splice(r,1))}for(let e=0;e<t.length;e++){let n=t[e];o.enableVertexAttribArray(n),b.push(n)}let e=Object.keys(E);for(let n=0;n<e.length;n++){let r=e[n];t.indexOf(r)<0&&E[r]>0&&(o.vertexAttribDivisor(r,0),E[r]=0)}}function e(t,e){for(let n=0;n<t.length;n++){let r=t[n];E.hasOwnProperty(r)?E[r]!==e&&(o.vertexAttribDivisor(r,e),E[r]=e):(o.vertexAttribDivisor(r,e),E[r]=e)}}function n(t,e,n,a){if(M){let i=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,i);let u=new Float32Array(16*n.length);for(let t=0;t<n.length;t++){let e=n[t];for(let n=0;n<16;n++)u[16*t+n]=e[n]}o.bufferData(o.ARRAY_BUFFER,u,o.STATIC_DRAW);let l=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,l);let s=new Float32Array(4*e.length);for(let t=0;t<e.length;t++){let n=e[t];for(let e=0;e<4;e++)s[4*t+e]=n[e]}o.bufferData(o.ARRAY_BUFFER,s,o.STATIC_DRAW),f.push({mesh:t,modelBufferId:i,instanceCount:n.length,colorBufferId:l,textureName:a,programId:r.INSTACE_PROGRAM})}else for(let o=0;o<n.length;o++){let i=mat4.clone(n[o]),u=vec4.clone(e[o]);f.push({mesh:t,transform:i,color:u,textureName:a,programId:r.DEFAULT_PROGRAM})}}let i=this,u=null,l=null,s={},c=null,f=[],h=[],m={},M=!1,d={r:.5,g:.5,b:.5,a:1},v={width:0,height:0,element:void 0},p=mat4.create();this.translation=vec3.create(),this.scale=vec3.fromValues(1,1,1),this.rotation=mat4.create();let b=[],E={};this.buildShader=function(t,e){let n=o.createShader(e);return o.shaderSource(n,t),o.compileShader(n),o.getShaderParameter(n,o.COMPILE_STATUS)?n:(console.log(o.getShaderInfoLog(n)),null)},this.loadShaders=function(t,e,n){let a=n||"_default";o.useProgram(null);let c=i.buildShader(t,o.VERTEX_SHADER),f=i.buildShader(e,o.FRAGMENT_SHADER);if(c&&f){let t=o.createProgram();if(o.attachShader(t,c),o.attachShader(t,f),o.linkProgram(t),!o.getProgramParameter(t,o.LINK_STATUS))return void console.log("Error initing shader program");o.useProgram(t);let e=o.getAttribLocation(t,"position"),n=o.getAttribLocation(t,"normal"),i=o.getAttribLocation(t,"texcoord"),h=o.getAttribLocation(t,"model"),m=o.getAttribLocation(t,"colorInstance"),M=[];e>=0&&M.push(e),n>=0&&M.push(n),i>=0&&M.push(i),m>=0&&M.push(m);let d=[];h>=0&&(M.push(h),d.push(h),M.push(h+1),d.push(h+1),M.push(h+2),d.push(h+2),M.push(h+3),d.push(h+3));let v={program:t,positionVertex:e,normalVertex:n,texcoord:i,model:h,colorInstance:m,modelViewProjectionUniform:o.getUniformLocation(t,"modelViewProjection"),modelViewUniform:o.getUniformLocation(t,"modelView"),normalMatrixUniform:o.getUniformLocation(t,"normalMatrix"),lightPositionUniform:o.getUniformLocation(t,"lightPosition"),colorUniform:o.getUniformLocation(t,"color"),useTextureUniform:o.getUniformLocation(t,"useTexture"),unlitUniform:o.getUniformLocation(t,"unlit"),texSamplerUniform:o.getUniformLocation(t,"texSampler"),id:a,attribs:M,modelAttribs:d,isInstance:a===r.INSTACE_PROGRAM};a===r.DEFAULT_PROGRAM?u=v:a===r.INSTACE_PROGRAM&&(l=v),s[a]=v,o.useProgram(null),console.log("succesfully loaded shaders")}else console.log("Error loading shaders")},this.uploadBuffer=function(t){let e=o.createBuffer();return o.bindBuffer(o.ARRAY_BUFFER,e),o.bufferData(o.ARRAY_BUFFER,new Float32Array(t),o.STATIC_DRAW),e},this.uploadMesh=function(t,e){if(!t){throw"Vertices can not be null"}if(!e){throw"Elements can not be null"}let n=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,n),t.constructor===Float32Array?o.bufferData(o.ARRAY_BUFFER,t,o.STATIC_DRAW):o.bufferData(o.ARRAY_BUFFER,new Float32Array(t),o.STATIC_DRAW);let r=o.createBuffer();return o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,r),e.constructor!==Uint16Array?o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),o.STATIC_DRAW):o.bufferData(o.ELEMENT_ARRAY_BUFFER,e,o.STATIC_DRAW),{verticesBufferId:n,elementsBufferId:r,count:e.length}},this.addObject=function(t,e,n,a,o){let u=i.uploadMesh(t,e),l=mat4.create();a&&mat4.copy(l,a);let s=vec4.fromValues(.8,.8,.8,1);n||(s=vec4.clone(n)),f.push({mesh:u,transform:l,color:n,textureName:o,programId:r.DEFAULT_PROGRAM})},this.addInstance=function(t,e,r,a){if(!r){throw"Matrices can not be null"}if(!e){throw"Colors can not be null"}e.length===r.length?n(t,e,r,a):console.log("Colors and instances must have same length")},this.addObjectInstances=function(t,e,r,a,o){if(!a){throw"Matrices can not be null"}if(!r){throw"Colors can not be null"}r.length===a.length?n(i.uploadMesh(t,e),r,a,o):console.log("Colors and instances must have same length")},this.addLines=function(t,e){let n=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,n),o.bufferData(o.ARRAY_BUFFER,new Float32Array(t),o.STATIC_DRAW),e||(e=vec4.fromValues(1,1,1,1)),h.push({verticesBufferId:n,count:t.length/3,vertexSize:12,color:e})},this.addTexture=function(t,e,n){let r=o.createTexture();o.bindTexture(o.TEXTURE_2D,r),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!0),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,e),(n=null!==n&&void 0!==n&&n)?(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST)):(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR)),o.bindTexture(o.TEXTURE_2D,null),m[t]=r,i.draw()},this.clearBatches=function(){for(let t=0;t<f.length;t++){let e=f[t];o.deleteBuffer(e.verticesBufferId),o.deleteBuffer(e.elementsBufferId)}f=[]},this.draw=function(){if(o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),0==f.length&&0==h.length)return;let n=mat4.create(),r=p,a=mat4.create(),l=mat4.create(),M=mat4.create();mat4.perspective(a,45,v.width/v.height,.1,1e5);let d=null,b=null,E=null,A=null,R=!1;o.activeTexture(o.TEXTURE0);for(let h=0;h<f.length;h++){let v=f[h],p=null;if(v.programId){if(!s.hasOwnProperty(v.programId)){console.log("Program not found!");continue}p=s[v.programId]}else p=u;if(d!==p){t((d=p).attribs),o.useProgram(d.program);let e=vec3.fromValues(0,0,0);o.uniform3fv(d.lightPositionUniform,e),o.uniform1f(d.unlitUniform,0)}d.isInstance||mat4.copy(n,v.transform);let x=mat4.create();mat4.scale(n,n,i.scale),mat4.multiply(n,i.rotation,n),mat4.multiply(l,r,n),mat4.multiply(M,a,l),mat4.invert(x,l),mat4.transpose(x,x),o.uniformMatrix4fv(d.modelViewUniform,!1,l),o.uniformMatrix4fv(d.modelViewProjectionUniform,!1,M),o.uniformMatrix4fv(d.normalMatrixUniform,!1,x);if(b!==v.mesh.verticesBufferId){if(o.bindBuffer(o.ARRAY_BUFFER,v.mesh.verticesBufferId),o.vertexAttribPointer(d.positionVertex,3,o.FLOAT,!1,32,0),o.vertexAttribPointer(d.normalVertex,3,o.FLOAT,!1,32,12),o.vertexAttribPointer(d.texcoord,2,o.FLOAT,!1,32,24),d.isInstance){o.bindBuffer(o.ARRAY_BUFFER,v.modelBufferId);for(let t=0;t<4;t++)o.vertexAttribPointer(d.model+t,4,o.FLOAT,!1,64,16*t);e(d.modelAttribs,1);o.bindBuffer(o.ARRAY_BUFFER,v.colorBufferId),o.vertexAttribPointer(d.colorInstance,4,o.FLOAT,!1,16,0),e(d.colorInstance,1)}b=v.mesh.verticesBufferId}if(E!==v.mesh.elementsBufferId&&(o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,v.mesh.elementsBufferId),E=v.mesh.elementsBufferId),v.textureName&&m.hasOwnProperty(v.textureName)){let t=m[v.textureName];A!==t&&(o.uniform1i(p.texSamplerUniform,0),o.bindTexture(o.TEXTURE_2D,t),o.uniform1f(d.useTextureUniform,1),t=t)}else A!==c&&(o.uniform1i(p.texSamplerUniform,0),o.bindTexture(o.TEXTURE_2D,c),o.uniform1f(d.useTextureUniform,0),A=c);d.isInstance||(v.color>=1&&R?(o.disable(o.BLEND),R=!1):v.color<1&&!R&&(o.enable(o.BLEND),R=!0),o.uniform4fv(d.colorUniform,v.color)),d.isInstance?o.drawElementsInstanced(o.TRIANGLES,v.mesh.count,o.UNSIGNED_SHORT,0,v.instanceCount):o.drawElements(o.TRIANGLES,v.mesh.count,o.UNSIGNED_SHORT,0)}o.uniform1f(d.unlitUniform,1);for(let t=0;t<h.length;t++){let e=h[t];o.uniform1i(program.texSamplerUniform,0),o.bindTexture(o.TEXTURE_2D,c),o.uniform1f(d.useTextureUniform,0),o.bindBuffer(o.ARRAY_BUFFER,e.verticesBufferId),o.vertexAttribPointer(d.positionVertex,3,o.FLOAT,!1,e.vertexSize,0),o.vertexAttribPointer(d.normalVertex,3,o.FLOAT,!1,e.vertexSize,0),o.vertexAttribPointer(d.texcoord,2,o.FLOAT,!1,e.vertexSize,0),o.drawArrays(o.LINES,0,e.count)}o.bindTexture(o.TEXTURE_2D,null),o.useProgram(null)},this.updateViewBounds=function(){let t=v.element.getBoundingClientRect();v.width=t.width,v.height=t.height},this.onResize=function(){v.element&&(i.updateViewBounds(),u&&i.draw())},this.setBackgroundColor=function(t,e,n){d.r=t,d.g=e,d.b=n,o&&o.clearColor(t,e,n,1)},this.load=function(t){if(v.element=t,o=t.getContext("webgl2"))M=!0;else if(!(o=t.getContext("webgl")))return!1;i.updateViewBounds(),window.addEventListener("resize",t=>{i.onResize()}),i.loadShaders(a.VERTEX_SHADER_SOURCE,a.FRAGMENT_SHADER_SOURCE,r.DEFAULT_PROGRAM),M&&i.loadShaders(a.INSTANCE_VERTEX_SHADER_SOURCE,a.FRAGMENT_SHADER_SOURCE,r.INSTACE_PROGRAM),o.clearColor(d.r,d.g,d.b,d.a),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),console.log("Init complete"),o.enable(o.DEPTH_TEST),c=o.createTexture(),o.bindTexture(o.TEXTURE_2D,c);let e=[];for(let t=0;t<16;t++)e.push(0);return o.texImage2D(o.TEXTURE_2D,0,o.RGBA,2,2,0,o.RGBA,o.UNSIGNED_BYTE,new Uint8Array(e)),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.bindTexture(o.TEXTURE_2D,null),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),!0},this.setViewMatrix=function(t){p=mat4.clone(t)},this.setScale=function(t){i.scale=vec3.clone(t)}}const a=t("./shaders");let o=null;r.DEFAULT_PROGRAM="_default",r.INSTACE_PROGRAM="_instance",e.exports=r},{"./shaders":7}],7:[function(t,e,n){n.VERTEX_SHADER_SOURCE=`\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 texcoord;\n\nuniform highp mat4 modelView;\nuniform highp mat4 modelViewProjection;\nuniform highp mat4 normalMatrix;\nuniform vec4 color;\n\nvarying vec4 currentColor;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vTexcoord;\n\n\nvoid main (void)\n{\n    gl_Position =  modelViewProjection * vec4(position, 1.0);\n    \n    currentColor = color;\n\n    vTexcoord = texcoord;\n\n    vec4 vPosition4 = modelView * vec4(position, 1.0);\n    vPosition = vPosition4.xyz / vPosition4.w;\n    \n    vNormal = mat3(normalMatrix) * normal;\n    vNormal = normalize(vNormal);\n}\n`,n.FRAGMENT_SHADER_SOURCE=`\nprecision mediump float;\nvarying vec4 currentColor;\nvarying vec3 vNormal;\nvarying vec2 vTexcoord;\nvarying vec3 vPosition;\nuniform vec3 lightPosition;\nuniform sampler2D texSampler;\nuniform float useTexture;\nuniform float unlit;\n\nvoid main(void)\n{\n    if(unlit >0.0)\n    {\n        gl_FragColor = currentColor;\n    }\n    else\n    {\n        vec3 lightDir = normalize(lightPosition - vPosition);\n    \n        // Ambient\n        vec3 ambient = vec3(0.1);\n        float d = abs(dot(vNormal, lightDir));\n        \n        // Diffuse\n        vec3 diffuse = vec3(d);\n        \n        vec3 illumination = diffuse + ambient;\n        if(useTexture == 0.0)\n        {\n            gl_FragColor = vec4(illumination * currentColor.rgb, currentColor.a);\n            // gl_FragColor = vec4(vNormal, 1.0);\n        }\n        else\n        {\n            vec4 texel = texture2D(texSampler, vTexcoord);\n            gl_FragColor = vec4(illumination * currentColor.rgb * texel.rgb, currentColor.a);\n            \n            // gl_FragColor = vec4(vTexcoord, 0, currentColor.a);\n        }\n    }\n}\n`,n.INSTANCE_VERTEX_SHADER_SOURCE=`\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 texcoord;\nattribute highp mat4 model;\nattribute vec4 colorInstance;\n\nuniform highp mat4 modelViewProjection;\nuniform highp mat4 modelView;\nuniform highp mat4 normalMatrix;\nuniform vec4 color;\n\nvarying vec4 currentColor;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vTexcoord;\n\n\nvoid main (void)\n{\n    gl_Position =  modelViewProjection * model * vec4(position, 1.0);\n    \n    currentColor = colorInstance;\n\n    vTexcoord = texcoord;\n\n    vec4 vPosition4 = modelView  * model * vec4(position, 1.0);\n    vPosition = vPosition4.xyz / vPosition4.w;\n    \n    vNormal = mat3(modelView) * mat3(model) * normal;\n    vNormal = normalize(vNormal);\n}\n\n`},{}],8:[function(t,e,n){"use strict";e.exports=function(){let t=this,e=new Date;this.elapsedTime=function(){let t=parseFloat(e.getTime()),n=(new Date).getTime();return((n=parseFloat(n))-t)/1e3},this.restart=function(){e=new Date},this.tick=function(e){console.log(e+" "+t.elapsedTime()),t.restart()}}},{}]},{},[1]);
